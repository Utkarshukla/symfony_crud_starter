steps

### 1) Prerequisites (Windows)

Check you have these installed and on PATH:

```powershell
php -v
composer -V
git --version
```

If any are missing, install via `winget`:

```powershell
winget install --id=PHP.PHP -e
winget install --id=Composer.Composer -e
winget install --id=Git.Git -e
```

Optional: make Symfony CLI available globally (or call it via relative path as below):

```powershell
setx PATH "$($env:Path);C:\Users\shukl\Downloads\symfony-cli_windows_amd64"
```

### 2) Create project (already done)

```powershell
.\symfony.exe version
.\symfony.exe check:requirements
.\symfony.exe new my_app --webapp
cd .\my_app
```

### 3) Run the local web server

```powershell
..\symfony.exe serve --no-tls --port=8000
```

Open: http://127.0.0.1:8000

If you prefer TLS: remove `--no-tls`.

### 4) Database setup (SQLite for dev)

The Webapp preset includes Doctrine. Ensure `.env` has SQLite:

```
DATABASE_URL="sqlite:///%kernel.project_dir%/var/data.db"
```

Then install the Maker bundle (dev only):

```powershell
composer require symfony/maker-bundle --dev
```

### 5) Create User + Authentication

Create a `User` entity compatible with Symfony Security:

```powershell
php bin/console make:user
# Name: User
# Identifier: email (unique)
# Store in the database: Yes (Entity)
# Add password field: Yes
```

Generate a login form authenticator and controller:

```powershell
php bin/console make:auth
# Choose: Login form authenticator
# Generate controller: Yes (SecurityController)
```

Run migrations to persist the `User` table:

```powershell
php bin/console make:migration
php bin/console doctrine:migrations:migrate -n
```

Security hardening (already mostly enabled by Webapp):
- CSRF protection is enabled for forms
- Passwords are hashed using secure algorithms
- Session cookie is `SameSite=Lax` by default

Enable login throttling (rate limit) to slow brute force attempts:

Create `config/packages/rate_limiter.yaml`:

```yaml
framework:
  rate_limiter:
    login:
      policy: 'sliding_window'
      limit: 5
      interval: '1 minute'
```

In `config/packages/security.yaml`, enable:

```yaml
security:
  firewalls:
    main:
      login_throttling:
        limiter: login
```

### 6) Pages (controllers + routes)

Home page and Dashboard:

```powershell
php bin/console make:controller HomeController
php bin/console make:controller DashboardController
```

Edit the generated controllers to use these routes:
- `/` → home (public)
- `/dashboard` → dashboard (authenticated)

Restrict access in `config/packages/security.yaml`:

```yaml
security:
  access_control:
    - { path: '^/login$', roles: PUBLIC_ACCESS }
    - { path: '^/logout$', roles: PUBLIC_ACCESS }
    - { path: '^/todos/public', roles: PUBLIC_ACCESS }
    - { path: '^/dashboard', roles: ROLE_USER }
    - { path: '^/(todo|category|comment)', roles: ROLE_USER }
```

### 7) Domain model: Todos, Categories, Comments

Entities and relationships:
- Todo ↔ Category: many-to-many
- Todo → Comments: one-to-many
- (Optional) Comment → User author: many-to-one

Create entities using the maker prompts.

Todo:

```powershell
php bin/console make:entity Todo
# title: string (length 180)
# description: text (nullable)
# dueAt: datetime_immutable (nullable)
# isCompleted: boolean (default false)
# categories: ManyToMany -> Category (inversedBy: todos)
# comments: OneToMany -> Comment (mappedBy: todo, orphanRemoval: true)
```

Category:

```powershell
php bin/console make:entity Category
# name: string (length 120, unique)
# todos: ManyToMany -> Todo (mappedBy: categories)
```

Comment:

```powershell
php bin/console make:entity Comment
# content: text
# createdAt: datetime_immutable (default: now)
# todo: ManyToOne -> Todo (inversedBy: comments, not nullable)
# (optional) author: ManyToOne -> User (nullable)
```

Run migrations:

```powershell
php bin/console make:migration
php bin/console doctrine:migrations:migrate -n
```

### 8) CRUD scaffolding

Generate CRUD for each aggregate (adjust templates as needed):

```powershell
php bin/console make:crud Todo
php bin/console make:crud Category
php bin/console make:crud Comment
```

Public listing route for todos:
- Keep `/todos/public` route in the `TodoController` to show only public info (no sensitive data, no user-only actions)
- Keep management routes (`/todo/*`, `/category/*`, `/comment/*`) behind `ROLE_USER`

### 9) Forms, CSRF, Validation

- Forms generated by Maker include CSRF tokens by default
- Add validation rules in `src/Entity/*` via PHP attributes, e.g. NotBlank, Length, DateTime
- Sanitize/escape output in Twig (`{{ variable }}` escapes by default)

### 10) Useful commands

```powershell
# Start server
..\symfony.exe serve --no-tls --port=8000

# Clear cache
php bin/console cache:clear

# Run migrations
php bin/console doctrine:migrations:migrate -n

# Create an admin user quickly (interactive)
php bin/console security:hash-password
```

### 11) Production notes (security)

- Never use the Symfony local server in production
- Use HTTPS, secure cookies (`cookie_secure: auto`), HSTS on your reverse proxy
- Keep `APP_ENV=prod` and `APP_DEBUG=0` in production; warm up cache
- Store secrets with `bin/console secrets:*` instead of `.env`

---

With the above, you have:
- Home page (public), Login page (public), Dashboard (ROLE_USER)
- Todo CRUD with Categories (many-to-many) and Comments (one-to-many)
- Public listing of todos at `/todos/public`

Next: customize controllers, templates, and add tests.
